(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{192:function(t,s,a){"use strict";a.r(s);var e=a(0),r=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("Daruk 实例包含下列方法:")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[a("a",{attrs:{href:"https://nodejs.org/api/net.html#net_server_listen_port_host_backlog_callback",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nodejs.org/api/net.html#net_server_listen_port_host_backlog_callback"),a("OutboundLink")],1)]),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._m(28),t._v(" "),a("p",[t._v("daruk 会按照约定的目录加载 middleware、controller、service 等，不过 daruk 也提供了编程式 api 接口，允许用户手动注册这些内容。这些 api 都采用统一形式的参数，以注册 middleware 为例：")]),t._v(" "),t._m(29),t._m(30),t._v(" "),t._m(31),t._v(" "),a("p",[t._v("注意：由于 controller 的目录结构涉及到路由 path 的定义，因此暂不支持通过编程式接口定义。")]),t._v(" "),a("p",[t._v("具体 api：")]),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),a("p",[t._v("// 日志输格式")]),t._v(" "),t._m(52),t._m(53),t._v(" "),t._m(54),t._v(" "),t._m(55),t._v(" "),t._m(56)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api","aria-hidden":"true"}},[this._v("#")]),this._v(" API")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"daruk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#daruk","aria-hidden":"true"}},[this._v("#")]),this._v(" Daruk")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("new Daruk(name: string, options: darukOptions)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("name: "),s("strong",[this._v("string")]),this._v(" Daruk app 实例名称")]),this._v(" "),s("p",[this._v("options: "),s("strong",[this._v("darukOptions")]),this._v(" 提供 Daruk 的目录名称")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("默认值")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("其他")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("options.debug")]),t._v(" "),a("td",[t._v("false")]),t._v(" "),a("td",[t._v("是否是 debug 模式")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("options.loggerOptions")]),t._v(" "),a("td",[t._v("同 daruk-logger")]),t._v(" "),a("td",[t._v("logger 配置")]),t._v(" "),a("td",[t._v("https://github.com/darukjs/daruk-logger")])]),t._v(" "),a("tr",[a("td",[t._v("options.customLogger")]),t._v(" "),a("td",[t._v("null")]),t._v(" "),a("td",[t._v("自定义 logger")]),t._v(" "),a("td",[t._v("需要实现 daruk-logger 类似的接口")])]),t._v(" "),a("tr",[a("td",[t._v("options.gracefulShutdown.enable")]),t._v(" "),a("td",[t._v("false")]),t._v(" "),a("td",[t._v("是否开启优雅关机")]),t._v(" "),a("td",[t._v("docker 已经根据 nginx 是否存在连接做了优雅关机，默认关闭")])]),t._v(" "),a("tr",[a("td",[t._v("options.gracefulShutdown.timeout")]),t._v(" "),a("td",[t._v("10*1000")]),t._v(" "),a("td",[t._v("关机超时")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("options.monitor.enable")]),t._v(" "),a("td",[t._v("false")]),t._v(" "),a("td",[t._v("是否开启 v8 profiler 监控路由")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("options.monitor.v8AnalyticsPath")]),t._v(" "),a("td",[t._v("'v8-analytics'")]),t._v(" "),a("td",[t._v("v8Analytic 安装路径")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("options.monitor.v8ProfilerPath")]),t._v(" "),a("td",[t._v("'v8-profiler-node8'")]),t._v(" "),a("td",[t._v("v8Profiler 安装路径")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("options.monitor.auth.name")]),t._v(" "),a("td",[t._v("''")]),t._v(" "),a("td",[t._v("访问监控路由的用户名")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("options.monitor.auth.password")]),t._v(" "),a("td",[t._v("''")]),t._v(" "),a("td",[t._v("访问监控路由的密码")]),t._v(" "),a("td",[t._v("-")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"listen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#listen","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#listen(...)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-启动-http-服务-该方法是对-koa-的-app-listen-的一次封装，调用方式一致-文档参考："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-启动-http-服务-该方法是对-koa-的-app-listen-的一次封装，调用方式一致-文档参考：","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 启动 http 服务,该方法是对 Koa 的 app.listen 的一次封装，调用方式一致,文档参考：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" daruk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"daruk"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("daruk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myapp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3030")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"run-port-number-string-host-string-function-cb-function-即将废弃-建议使用-listen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-port-number-string-host-string-function-cb-function-即将废弃-建议使用-listen","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#run(port:number|string, host?:string|Function, cb?:Function)")]),this._v(" (即将废弃,建议使用 listen)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-启动-http-服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-启动-http-服务","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 启动 http 服务")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-2","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("port: "),a("strong",[t._v("string|number")]),t._v(" 端口号")]),t._v(" "),a("p",[t._v("host: "),a("strong",[t._v("string|Function")]),t._v(" 启动的 host 或者成功的回调")]),t._v(" "),a("p",[t._v("cb: "),a("strong",[t._v("Function")]),t._v(" 成功的回调")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example","aria-hidden":"true"}},[this._v("#")]),this._v(" Example:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" daruk "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"daruk"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("daruk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myapp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3030")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.0.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"serverready-server-http-server-https-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#serverready-server-http-server-https-server","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#serverReady(server: Http.server | Https.server)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-服务启动后需要调用的函数，以完成剩余操作。用于不调用-run-方法的自定义启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-服务启动后需要调用的函数，以完成剩余操作。用于不调用-run-方法的自定义启动","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 服务启动后需要调用的函数，以完成剩余操作。用于不调用 run 方法的自定义启动")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-3","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("server: Http.createServer（或 Https.createServer） 的返回值")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"example-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-2","aria-hidden":"true"}},[this._v("#")]),this._v(" Example:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用 run 方法只能启动 http 服务")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https 服务需要自定义启动")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 类似于 koa 启动 https  服务")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://github.com/koajs/koa/issues/960")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" https "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" daruk "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./daruk.init"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./certificate/private.pem"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./certificate/ca.cer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" daruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  daruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serverReady")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("`server is starting at https://localhost:3000`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"mockcontext-req"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mockcontext-req","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#mockContext(req?: {})")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-用于在非请求链路中得到一个模拟的-context-对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-用于在非请求链路中得到一个模拟的-context-对象","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 用于在非请求链路中得到一个模拟的 Context 对象")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-4","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("req: "),s("strong",[this._v("{ [key: string]: any }")]),this._v(" 模拟的 request 对象")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"return-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#return-context","aria-hidden":"true"}},[this._v("#")]),this._v(" Return: Context")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"example-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-3","aria-hidden":"true"}},[this._v("#")]),this._v(" Example:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ctx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" darukInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mockContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"register"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#register","aria-hidden":"true"}},[this._v("#")]),this._v(" register")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/middleware/index.ts")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("daruk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  daruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerMiddleware")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// name 注册内容的 name，对应 daruk 自动 load 时的文件名或者文件夹名")]),t._v("\n    name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"koa-test-mid"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// export 导出的内容，对应 daruk 自动 load 时，模块导出的内容")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("export")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("需要注意的是，手动注册模块时，只能在约定目录对应的 index.ts 中执行，比如上面注册 middleware 的操作必须在 "),s("code",[this._v("src/middlewares/index.ts")]),this._v(" 执行，同样的注册其他模块的位置：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("src/middlewares/index.ts")]),t._v(" "),a("li",[t._v("src/services/index.ts")]),t._v(" "),a("li",[t._v("src/glues/index.ts")]),t._v(" "),a("li",[t._v("src/utils/index.ts")]),t._v(" "),a("li",[t._v("src/timers/index.ts")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"registermiddleware-describe-array-describe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#registermiddleware-describe-array-describe","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#registerMiddleware(describe | Array<describe>)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-注册中间件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-注册中间件","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 注册中间件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-5","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("describe：{")]),t._v(" "),a("p",[t._v("​ name: "),a("strong",[t._v("string")]),t._v(" 中间件名称")]),t._v(" "),a("p",[t._v("​ export: "),a("strong",[t._v("Function")]),t._v(" 中间件函数")]),t._v(" "),a("p",[t._v("}")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"registerservice-describe-array-describe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#registerservice-describe-array-describe","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#registerService(describe | Array<describe>)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-注册-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-注册-service","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 注册 service")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-6","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("describe：{")]),t._v(" "),a("p",[t._v("​ name: "),a("strong",[t._v("string")]),t._v(" service 名称")]),t._v(" "),a("p",[t._v("​ export: "),a("strong",[t._v("BaseService")]),t._v(" Daruk.BaseService 的子类")]),t._v(" "),a("p",[t._v("}")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"registerutil-describe-array-describe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#registerutil-describe-array-describe","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#registerUtil(describe | Array<describe>)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-注册-util"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-注册-util","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 注册 util")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-7"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-7","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("describe：{")]),t._v(" "),a("p",[t._v("​ name: "),a("strong",[t._v("string")]),t._v(" util 名称")]),t._v(" "),a("p",[t._v("​ export: "),a("strong",[t._v("any")]),t._v(" util 的内容")]),t._v(" "),a("p",[t._v("}")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"registertimer-describe-array-describe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#registertimer-describe-array-describe","aria-hidden":"true"}},[this._v("#")]),this._v(" "),s("em",[this._v("#registerTimer(describe | Array<describe>)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-注册-timer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-注册-timer","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 注册 Timer")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"parameters-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-8","aria-hidden":"true"}},[this._v("#")]),this._v(" Parameters:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("describe：{")]),t._v(" "),a("p",[t._v("​ name: "),a("strong",[t._v("string")]),t._v(" 定时器名字")]),t._v(" "),a("p",[t._v("​ export: "),a("strong",[t._v("TimerConfig")]),t._v(" 定时器配置")]),t._v(" "),a("p",[t._v("TimerConfig:\n​ {")]),t._v(" "),a("p",[t._v("​ cronTime: "),a("strong",[t._v("string")]),t._v(", // crontab 风格的配置")]),t._v(" "),a("p",[t._v("​ onTick: "),a("strong",[t._v("function")]),t._v(" 定时器触发的回调")]),t._v(" "),a("p",[t._v("​ onComplete: "),a("strong",[t._v("function")]),t._v(" 定时器完成的回调")]),t._v(" "),a("p",[t._v("​ }")]),t._v(" "),a("p",[t._v("}")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"logger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#logger","aria-hidden":"true"}},[this._v("#")]),this._v(" logger")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-日志输出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-日志输出","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 日志输出")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"example-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-4","aria-hidden":"true"}},[this._v("#")]),this._v(" Example:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// daruk.logger 只是对 daruk-logger 实例的引用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// daruk-logger 文档：https://github.com/darukjs/daruk-logger")]),t._v("\ndaruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"warn message"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 警告日志")]),t._v("\ndaruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error message"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 错误日志，Object 会被 stringify")]),t._v("\ndaruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 普通日志")]),t._v("\ndaruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// debug日志")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"level"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"warn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"logType"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myapp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"fileinfo"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/src/index.ts:283:25"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"os_hostname"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hahahh.local"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1538020260774")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"exithook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#exithook","aria-hidden":"true"}},[this._v("#")]),this._v(" exitHook")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"desc-进程退出的回调"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#desc-进程退出的回调","aria-hidden":"true"}},[this._v("#")]),this._v(" Desc: 进程退出的回调")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"example-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-5","aria-hidden":"true"}},[this._v("#")]),this._v(" Example:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// daruk.exitHook 只是对 daruk-exit-hook 实例的引用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// daruk-exit-hook 文档：https://github.com/darukjs/daruk-exit-hook")]),t._v("\ndaruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exitHook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addHook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    daruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  daruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"process exiting"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 支持异步任务")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    daruk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"process exited"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])}],!1,null,null,null);s.default=r.exports}}]);